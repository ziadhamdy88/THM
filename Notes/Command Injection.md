- The abuse of an application's behavior to execute commands on the OS, using the same privileges that the application on a device is running with.
- The attacker may read system or user files, data, etc..
- ## *Discovering*
	- Occurs due to the nature of some functions in programming languages that pass data and make system calls on the machine's OS.
	- For example, taking input from user, and searching for an entry into a file.
	- #### *Types*
		- **Blind**
			- When no output from the application is visible, we'll have to investigate the behaviors of the application to determine whether or not your payload was successful.
			- We'll need to use payloads that cause some time delay, like the `ping` and `sleep` commands.
			- Another method of detection is by forcing some output. This can be done by using redirection operators such as `>`.
			- For example, we can tell the web app to execute the command `whoami` and redirect that to a file. Then we can use a `cat` to read that file and confirm.
			- The `curl` command could be used also, to deliver data to and from an application in our payload `curl http://vulnerable.app/process.php%3Fsearch%3DThe%20Beatles%3B%20whoami`.
		- **Verbose**
			- When there is direct feedback from the application.
			- Detecting is very easy since we can see the output, for example, the output of `ping` and `whoami` commands is displayed on the web app.
	- #### *Useful Payloads*
		- **Linux**
			- `whoami`
			- `ls`
			- `ping` this command invokes the app to hang, making it noticeable.
			- `sleep`
			- `nc` can spawn reverse shells onto the vulnerable app.
		- **Windows**
			- `whoami`
			- `dir`
			- `ping`
			- `timeout` this command also invokes the app to hang.
- ## *Remediation*
	- Minimal use of potentially dangerous functions or libraries in a programming language to filtering input without relying on a user's input.
	- #### *PHP*
		- **Vulnerable Functions**
			- Functions that interact with the OS to execute commands `Exec`, `Passthru`, `System`.
			- These functions take input such as a string or user data and will execute whatever is provided on the system. Any application that uses these functions without proper checks will be vulnerable to command injection.
		- **Input Sanitisation**
			- Sanitizing any input from a user that an application uses is a great way to prevent command injection.
			- This is a process of specifying the formats or types of data that a user can submit. For example, an input field that only accepts numerical data or removes any special characters such as `>` ,  `&` and `/`.
			- Using `filter_input` function to check whether or not the data inputted is in a certain form.
			- **Bypassing Filters**
				- Applications will employ numerous techniques in filtering and sanitizing data that is taken from a  user's input.
				- For example, an application may strip out quotation marks; we can instead use the hexadecimal value of this to achieve the same result.
